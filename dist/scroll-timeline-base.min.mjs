const f="block",u=new WeakMap,r=new WeakMap;function y(t,e){if(["x","y"].includes(t))return t;if(!e)throw new Error("To determine the normalized axis the computedStyle of the source is required.");const i=e.writingMode=="horizontal-tb";if(t==="block")t=i?"y":"x";else if(t==="inline")t=i?"x":"y";else throw new TypeError(`Invalid axis \u201C${t}\u201D`);return t}function g(t){return t===document.scrollingElement?document:t}function w(t,e){if(!t)return null;const i=r.get(t).sourceMeasurements,o=getComputedStyle(t);let n=i.scrollTop;return y(e,o)==="x"&&(n=Math.abs(i.scrollLeft)),n}function b(t,e){const i=r.get(t).sourceMeasurements,o=getComputedStyle(t).writingMode=="horizontal-tb";return e==="block"?e=o?"y":"x":e==="inline"&&(e=o?"x":"y"),e==="y"?i.scrollHeight-i.clientHeight:i.scrollWidth-i.clientWidth}function h(t){return["block","inline","x","y"].includes(t)}function m(t){const e=getComputedStyle(t);return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,clientWidth:t.clientWidth,clientHeight:t.clientHeight,writingMode:e.writingMode,direction:e.direction,scrollPaddingTop:e.scrollPaddingTop,scrollPaddingBottom:e.scrollPaddingBottom,scrollPaddingLeft:e.scrollPaddingLeft,scrollPaddingRight:e.scrollPaddingRight}}function p(t){const e=r.get(t);e.sourceMeasurements=m(t),!e.updateScheduled&&(setTimeout(()=>{for(const i of e.timelineRefs)i.deref();e.updateScheduled=!1}),e.updateScheduled=!0)}function v(t,e){const i=u.get(t),o=i.source;if(o!=e){if(o){const n=r.get(o);if(n){n.timelineRefs.delete(t);const s=Array.from(n.timelineRefs).filter(c=>typeof c.deref()>"u");for(const c of s)n.timelineRefs.delete(c);n.timelineRefs.size===0&&(n.disconnect(),r.delete(o))}}if(i.source=e,e){let n=r.get(e);if(!n){n={timelineRefs:new Set,sourceMeasurements:m(e)},r.set(e,n);const s=new ResizeObserver(l=>{for(let d=0,x=l.length;d<x;d++)p(i.source)});s.observe(e);for(const l of e.children)s.observe(l);const c=new MutationObserver(l=>{for(const d of l)d.target instanceof Element&&p(d.target)});c.observe(e,{attributes:!0,attributeFilter:["style","class"]});const a=()=>{n.sourceMeasurements.scrollLeft=e.scrollLeft,n.sourceMeasurements.scrollTop=e.scrollTop;for(const l of n.timelineRefs)l.deref()};g(e).addEventListener("scroll",a),n.disconnect=()=>{s.disconnect(),c.disconnect(),g(e).removeEventListener("scroll",a)}}n.timelineRefs.add(new WeakRef(t))}}}class M{constructor(e){u.set(this,{source:null,axis:f});const i=e&&e.source!==void 0?e.source:document.scrollingElement;if(v(this,i),e&&e.axis!==void 0&&e.axis!=f){if(!h(e.axis))throw TypeError("Invalid axis");u.get(this).axis=e.axis}}cancel(){r.get(this.source).disconnect()}get source(){return u.get(this).source}set source(e){v(this,e)}get axis(){return u.get(this).axis}set axis(e){if(!h(e))throw TypeError("Invalid axis");u.get(this).axis=e}get phase(){const e=this.source;if(!e)return"inactive";const i=getComputedStyle(e);return i.display=="none"||e!=document.scrollingElement&&(i.overflow=="visible"||i.overflow=="clip")?"inactive":"active"}get duration(){return{value:100}}get currentTime(){const e=this.source;if(!e||!e.isConnected||this.phase=="inactive")return null;const i=getComputedStyle(e);if(i.display==="inline"||i.display==="none")return null;const o=this.axis,n=w(e,o),s=b(e,o);return s>0?{value:100*n/s}:{value:100}}}export{M as ScrollTimeline};
